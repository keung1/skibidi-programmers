<%- include("partials/header") %>
<main>
    <div class="container">
        <h1>Pokémon Battler</h1>
        
        <section id="search" action="/search" method="post">
            <button id="randomButton" type="button" class="random-opponent">Random</button>
            <input type="text" placeholder="Type Pokémon Naam">
            <button class="submit" type="submit">Zoek</button>
        </section>
        
        <div class="pokemon-container">
            <div class="player-pokemon">
                <div class="player-image">
                    <h2>Jouw Pokémon</h2>
                    <img id="playerImage" src="assets/images/pikachu.png" alt="Pikachu">
                </div>
                <div class="player-info">
                    <h2>Naam: Pikachu</h2>
                    <article class="player-info-stat">
                        <h3>8</h3>
                        <p>Level</p>
                    </article>
                    <article class="player-info-stat">
                        <h3>18</h3>
                        <p>Aanval</p>
                    </article>
                    <article class="player-info-stat">
                        <h3>8</h3>
                        <p>Verdediging</p>
                    </article>
                    <article class="player-info-stat">
                        <h3><span id="playerHP">90</span></h3>
                        <p>HP</p>
                    </article>
                </div>
            </div>
            
            <div class="opponent-pokemon">
                <div class="opponent-image">
                    <h2>Tegenstander Pokémon</h2>
                    <img id="opponentImage" src="" alt="">
                </div>
                <div class="opponent-info">
                    <h2>Naam: <span id="opponentName"></span></h2>
                    <article class="opponent-info-stat">
                        <h3 id="opponentLevel">0</h3>
                        <p>Level</p>
                    </article>
                    <article class="opponent-info-stat">
                        <h3 id="opponentAttack">0</h3>
                        <p>Aanval</p>
                    </article>
                    <article class="opponent-info-stat">
                        <h3 id="opponentDefense">0</h3>
                        <p>Verdediging</p>
                    </article>
                    <article class="opponent-info-stat">
                        <h3 id="opponentHP">0</h3>
                        <p>HP</p>
                    </article>
                </div>
                <div id="opponentContainer">
                    <% if (opponentHTML) { %>
                        <%= opponentHTML %>
                    <% } else { %>
                        <p>Geen tegenstander beschikbaar</p>
                    <% } %>
                </div>
            </div>
        </div>
        
        <a type="submit" class="attack-btn"><img id="attack-btn" src="assets/images/Pokeball-3.png"></a>
        
        <div class="result" id="result"></div>
    </div>
</main>

<%- include("partials/footer") %>

<script>
    document.getElementById('randomButton').addEventListener('click', async function() {
        try {
            const response = await fetch('/random-pokemon');
            const randomPokemon = await response.json();
            displayOpponent(randomPokemon);
        } catch (error) {
            console.error('Fout bij het ophalen van een willekeurige Pokémon:', error);
        }
    });

    function displayOpponent(opponent) {
        document.getElementById('opponentImage').src = opponent.image;
        document.getElementById('opponentName').innerText = opponent.name;
        document.getElementById('opponentLevel').innerText = opponent.level;
        document.getElementById('opponentAttack').innerText = opponent.attack;
        document.getElementById('opponentDefense').innerText = opponent.defense;
        document.getElementById('opponentHP').innerText = opponent.hp;
    }
</script>
